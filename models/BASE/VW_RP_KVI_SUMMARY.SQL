{{ config(materialized='view') }}

WITH source -- the CTE view name
	AS(
     SELECT KVISUMMARYINTID AS KVI_SUMMARY_ID
          , USR_ID AS EMPLOYEE_ID
          , WH_ID AS MARKET_ID
          , JOBCODEINTID AS JOB_CODE_ID
          , JOBCODEID AS JOB_CODE_NM
          , SUPERVISOR_ID
          , WAR_INT_ID AS WORK_AREA_ID
          , AISLEAREA_INT_ID AS AISLE_AREA_ID
          , AISLE_AREA_ID AS AISLE_AREA_NM
          , PLAN_DATE
          , STARTLOCATIONID AS START_LOC_ID
          , ENDLOCATIONID AS END_LOC_ID
          , START_TIME AS START_TS
          , STOP_TIME AS END_TS
          , ACTUAL_SECONDS AS ACTL_SECS_QTY
          , GOAL_SECONDS
          , BREAK_SECONDS
          , PERFORMANCE
          , EXPECTED_PERF
          , CSTNUM AS CUST_NB
          , ROUTE_NUM AS ROUTE_NB
          , BLENDED_COST
          , BASE_PF_D
          , ASSIGN_NUM AS ASSIGN_NB
          , KVI_TMU_05 AS KVI_CASES
          , KVI_TMU_03 AS KVI_PALLETS 
          , KVI_TMU_06 AS VOLUME
          , KVI_TMU_04 AS PRODUCTS
          , NUM_SHIP AS TOTAL_CASES
          , TOTAL_CUBE AS TOTAL_CUBES
          , TOTAL_WEIGHT
          , DISCRETE AS DISCRETE_FLG
          , DIRECT AS DIRECT_FLG
          , ISMEASURED AS MEASURED_FLG
          , ORDER_QTY
          , EXT_KVI_GOAL_SECONDS
          , EXT_DISCRETE_GOAL_SECONDS
          , INT_KVI_GOAL_SECONDS
          , INT_DISCRETE_GOAL_SECONDS
          , MACH_KVI_GOAL_SECONDS
          , MACH_DISCRETE_GOAL_SECONDS
          , EXT_ASSIGNMENTTIME AS EXT_ASSIGNMENT_TM
          , EXT_ORDERTIME AS EXT_ORDER_TM
          , INT_ASSIGNMENTTIME AS INT_ASSIGNMENT_TM
          , INT_ORDERTIME AS INT_ORDER_TM
          , MACH_ASSIGNMENTTIME AS MACH_ASSIGNMENT_TM
          , MACH_ORDERTIME AS MACH_ORDER_TM
          , PICK_ERROR_QTY
          , PICK_ERROR_COST
          , SRC_ID
        FROM {{ source('GOLD_RED_PRAIRIE', 'KVI_SUMMARY') }} 
    )

/* Outcome */
     SELECT *
       FROM SOURCE